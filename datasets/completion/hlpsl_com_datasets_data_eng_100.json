[
    {
        "file": "HLPSL-1/20172001_Assign_3.hlpsl",
        "incomplete": "____(ROLE_0)____ ____(ROLE_2)____ (Ui, ____(PARAM_2)____, GWN, SDj: ____(PARAM_3)____, ____(PARAM_1)____ : hash_func,\n____(PARAM_0)____ : symmetric_key, Snd, ____(PARAM_4)____: channel(____(PARAM_5)____))\nplayed_by Ui\ndef=\nlocal State: ____(VARIABLE_0)____, ____(VARIABLE_2)____, IDsdj, IDgwn, PWi, ____(VARIABLE_4)____, ____(VARIABLE_3)____, A: ____(VARIABLE_1)____,\nR, Kgwnui, Kgwnsdj, Rgwn, Rsdj, M1, Rui, TIDi,TIDinew: text,\nM2, M3, T3, T4, T1, Sigmai: text, Gen, Rep : hash_func\nconst ____(VARIABLE_6)____, ui_gwn_rui, gwn_ui_t4, ____(VARIABLE_5)____,____(VARIABLE_7)____: protocol_id\ninit State := 0\ntransition\n1. State = ____(STATE_0)____ /\\ ____(MESSAGE_41)____(start) =|>\n% Registration phase\nState' := 1 /\\ A' := new() /\\ R' := new()\n/\\ secret({PWi, BIOi, ____(EVENT_1)____, ____(EVENT_2)____}, sr1, ____(EVENT_0)____)\n/\\ Sigmai' := Gen(BIOi) /\\ RPWi' := xor(H(PWi.Sigmai'.A'), R')\n% Send registration request securely to RA\n/\\ Snd({____(MESSAGE_42)____}_SKuira)\n\n% Receive information securely from RA for SPi\n2. State = ____(STATE_1)____/\\Rcv({xor(H(____(MESSAGE_43)____),xor(H(PWi.Sigmai'.A'),R')).TIDi'}_SKuira)=|>\n% Login phase\nState' := 2\n% Send login request to GWN via public channel\n/\\ Rui' := new() /\\ T1' := new()/\\ M1' := H(IDi.Kgwnui)\n/\\ M2' := xor(M1', Rui') /\\ M3' := H(M2'.T1'.IDi'.TIDi'.Rui')\n/\\ ____(MESSAGE_44)____(TIDi'.M2'.M3'.T1')\n% Ui has freshly generated the values T1 and Rui for GWN\n/\\ witness(Ui,GWN,____(EVENT_3)____, ____(EVENT_4)____)\n/\\ ____(EVENT_5)____(Ui,GWN,ui_gwn_rui,____(EVENT_6)____)\n% Authentication and key agreement phase\n\n% Receive authentication reply from GWN via public channel\n3. State = 2 /\\ Rcv({Rui'.Rgwn'.Rsdj'.IDi.IDsdj.IDgwn.\nH(H(IDsdj.Kgwnsdj))}_H(IDi.Kgwnui).\nxor(TIDinew', H(TIDi'.H(IDi.Kgwnui).T3'.T4')).\nH(H(H(IDi.IDsdj.IDgwn.Rui'.Rgwn'.Rsdj'.\nH(H(IDi.Kgwnui)).H(H(IDsdj.Kgwnsdj))).T3').T4'.Rui').T3'.T4')=|>\n% Ui's acceptance of T4 and TIDinew generated for Ui by GWN\nState' := 3/\\____(EVENT_7)____(GWN,Ui,gwn_ui_t4,____(EVENT_8)____)/\\request(GWN,Ui,____(EVENT_9)____,____(EVENT_10)____)\nend ____(ROLE_1)____\n \n\nrole registrationauthority (Ui, RA, ____(PARAM_8)____, SDj: agent, H : ____(PARAM_7)____,\nSKuira : ____(PARAM_9)____, ____(PARAM_6)____, ____(PARAM_11)____: channel(____(PARAM_10)____))\nplayed_by RA\ndef=\nlocal ____(VARIABLE_8)____: nat, IDi, ____(VARIABLE_9)____, ____(VARIABLE_11)____, ____(VARIABLE_12)____, ____(VARIABLE_10)____, RPWi, ____(VARIABLE_13)____, Ai: text,\nR, Kgwnui, Kgwnsdj, Rgwn, Rsdj, T1, M1, Rui, TIDi,TIDinew: text,\nM2, M3, T3, T4, Sigmai: text, Gen, Rep : hash_func\nconst ____(VARIABLE_14)____,sr3: protocol_id\ninit State := 0\ntransition\n1. State = ____(STATE_2)____ /\\ Rcv({____(MESSAGE_45)____}_SKuira) =|>\nState' := 1 /\\ Kgwnui' := new()\n/\\ ____(EVENT_12)____(____(EVENT_13)____, ____(EVENT_11)____, {RA,GWN,Ui})\n/\\ ____(EVENT_16)____(____(EVENT_14)____, sr3, {RA,GWN,____(EVENT_15)____})\n/\\ Ai' := xor(H(IDi.Kgwnui'), RPWi')\n/\\ TIDi' := new()\n/\\ ____(MESSAGE_46)____({Ai'.TIDi'}_SKuira)\n\nend role\n\n\nrole gatewaynode (____(PARAM_14)____, RA, ____(PARAM_17)____, ____(PARAM_15)____: agent, ____(PARAM_12)____ : ____(PARAM_13)____,\nSKuira : symmetric_key, Snd, ____(PARAM_16)____: channel(dy))\nplayed_by GWN\ndef=\nlocal State: nat, IDi, IDsdj, IDgwn, ____(VARIABLE_18)____, ____(VARIABLE_16)____, RPWi, ____(VARIABLE_15)____: ____(VARIABLE_17)____,\nR, Kgwnui, Kgwnsdj, Rgwn, Rsdj, T1, T2, M1, Rui, TIDi,TIDinew, Ruistar: text,\nM2, M3, M4, M6, M7, M8, M10, M11, M12, T3, T4, Sigmai: text, Gen, Rep : hash_func\nconst ____(VARIABLE_21)____, gwn_sdj_rgwn, sdj_gwn_t3, sdj_gwn_rsdj, ____(VARIABLE_22)____, ui_gwn_rui, ____(VARIABLE_19)____, ____(VARIABLE_20)____: protocol_id\ninit State := 0\ntransition\n1. State = 0 /\\ ____(MESSAGE_47)____(TIDi'.xor(H(IDi.Kgwnui), Rui').H(xor(H(IDi.Kgwnui), Rui').T1'.IDi'.TIDi'.Rui').T1') =|>\nState' := 1 /\\ M4' := H(IDi.Kgwnui)\n/\\ ____(EVENT_17)____(____(EVENT_18)____,GWN,ui_gwn_t1, T1')\n/\\ ____(EVENT_20)____(Ui,____(EVENT_19)____,ui_gwn_rui,Rui')\n/\\ M2' := new()\n/\\ Ruistar' := xor(M2', M4')\n/\\ Rgwn' := new()\n/\\ T2' := new()\n/\\ M6' := H(IDsdj.Kgwnsdj)\n/\\ M7' := {IDi.IDgwn.Ruistar'.Rgwn.H(M4')}_M6'\n/\\ M8' := H(M6'.T2'.IDi.IDsdj.IDgwn.Rgwn')\n/\\ ____(MESSAGE_48)____(M7'.M8'.T2')\n/\\ witness(____(EVENT_22)____,SDj,____(EVENT_21)____, T2')\n/\\ ____(EVENT_23)____(____(EVENT_24)____,SDj,gwn_sdj_rgwn, Rgwn')\n\n2. State = 1 /\\ Rcv(____(MESSAGE_49)____) =|>\nState' := 2 /\\ TIDi' := new() /\\ Rgwn' := new() /\\ Rui' := new() /\\ Rsdj' := new()\t\t\t\t\t\t\t\n/\\ ____(EVENT_26)____(SDj,GWN,____(EVENT_25)____, T3')\n/\\ ____(EVENT_28)____(____(EVENT_27)____,GWN,sdj_gwn_rsdj, Rsdj')\n/\\ T4' := new()\n/\\ TIDinew' := new()\n/\\ Snd({Rui'.Rgwn'.Rsdj'.IDi.IDsdj.IDgwn.\nH(H(IDsdj.Kgwnsdj))}_H(IDi.Kgwnui).\nxor(TIDinew', H(TIDi'.H(IDi.Kgwnui).T3'.T4')).\nH(H(H(IDi.IDsdj.IDgwn.Rui'.Rgwn'.Rsdj'.\nH(H(IDi.Kgwnui)).H(H(IDsdj.Kgwnsdj))).T3').T4'.Rui').T3'.T4')\n/\\ ____(EVENT_30)____(____(EVENT_29)____,Ui,gwn_ui_t4, T4')\n/\\ witness(GWN,Ui,____(EVENT_32)____, ____(EVENT_31)____)\nend role\n\n\n\nrole smartdevice (____(PARAM_21)____, RA, GWN, ____(PARAM_18)____: agent, ____(PARAM_20)____ : ____(PARAM_23)____,\nSKuira : symmetric_key, ____(PARAM_19)____, Rcv: channel(____(PARAM_22)____))\nplayed_by SDj\ndef=\nlocal State: nat, IDi, ____(VARIABLE_23)____, IDgwn, PWi, BIOi, ____(VARIABLE_25)____, ____(VARIABLE_24)____: ____(VARIABLE_26)____,\nR, Kgwnui, Kgwnsdj, Rgwn, Rsdj, T2, M1, Rui, TIDi,TIDinew, Ruistar: text,\nM2, M3, M4, M6, M7, M8, M10, M11, M12, T3, T4, Sigmai: text, Gen, Rep : hash_func\nconst gwn_sdj_t2, gwn_sdj_rgwn, ____(VARIABLE_28)____, ____(VARIABLE_27)____: protocol_id\ninit State := 0\ntransition\n1. State = 0 /\\ Rcv({IDi.IDgwn.Ruistar'.Rgwn'.H(____(MESSAGE_50)____)}_M6'.M8'.T2') =|>\nState' := 1 /\\ Kgwnsdj' := new()\n/\\ request(GWN,____(EVENT_33)____,gwn_sdj_t2, ____(EVENT_34)____)\n/\\ request(____(EVENT_35)____,SDj,gwn_sdj_rgwn, ____(EVENT_36)____)\n/\\ Rsdj' := new()\n/\\ T3' := new()\n/\\ M10' := xor(H(H(IDsdj.Kgwnsdj').T3'), Rsdj')\n/\\ M11' := H(H(IDi.IDsdj.IDgwn.Ruistar'.Rgwn'.Rsdj'.H(M4').H(H(IDsdj.Kgwnsdj)).T3'))\n/\\ M12' := H(Rsdj'.Rgwn'.IDsdj.IDgwn.T3')\n/\\ ____(MESSAGE_51)____(M10'.M11'.M12'.T3')\n/\\ ____(EVENT_37)____(SDj,GWN,____(EVENT_38)____, T3')\n/\\ ____(EVENT_40)____(SDj,GWN,____(EVENT_39)____, Rsdj')\n\nend role\n\nrole session (____(PARAM_24)____, ____(PARAM_25)____, ____(PARAM_27)____, SDj: agent, H: hash_func, SKuira: ____(PARAM_26)____)\ndef=\nlocal S1, R1, S2, R2, S3, ____(VARIABLE_29)____, ____(VARIABLE_31)____, ____(VARIABLE_32)____: channel (____(VARIABLE_30)____)\ncomposition\nuser (Ui, RA, GWN, SDj, H, SKuira, S1, R1)\n/\\ registrationauthority(Ui, RA, GWN, SDj, H, SKuira, S2, R2)\n/\\ gatewaynode (Ui, RA, GWN, SDj, H, SKuira, S3, R3)\n/\\ smartdevice (Ui, RA, GWN, SDj, H, SKuira, S2, R2)\nend role\n\nrole environment()\ndef=\nconst ui, ____(VARIABLE_33)____, ____(VARIABLE_35)____, ____(VARIABLE_34)____: agent, ____(VARIABLE_36)____: hash_func, skuira: symmetric_key,\nkgwnui, kgwnsdj, idi, idsnj, idgwn, t1, t2, t3, t4, tidi, tidinew: text,\ngen, rep: hash_func, ui_gwn_t1, ui_gwn_rui, gwn_sdj_t2, gwn_sdj_rgwn,\nsdj_gwn_t3, sdj_gwn_rsdj, sr1, sr2, sr3: protocol_id\nintruder_knowledge ={t1, t2, t3, t4, h, gen, rep}\ncomposition\nsession(ui, ra, gwn, sdj, h, skuira) /\\ session(i, ra, gwn, sdj, h, skuira)\n/\\ session(ui, i, gwn, sdj, h, skuira) /\\ session(ui, ra, i, sdj, h, skuira)\n/\\ session(ui, ra, gwn, i, h, skuira)\nend role\ngoal\n____(GOAL_53)____ ____(GOAL_52)____, sr2, sr3\nauthentication_on ____(GOAL_54)____, ____(GOAL_55)____, gwn_sdj_t2\nauthentication_on ____(GOAL_56)____, sdj_gwn_t3, ____(GOAL_57)____\nauthentication_on ____(GOAL_58)____, gwn_ui_tidinew\nend goal\nenvironment()",
        "complete:": "role user (Ui, RA, GWN, SDj: agent, H : hash_func,\nSKuira : symmetric_key, Snd, Rcv: channel(dy))\nplayed_by Ui\ndef=\nlocal State: nat, IDi, IDsdj, IDgwn, PWi, BIOi, RPWi, A: text,\nR, Kgwnui, Kgwnsdj, Rgwn, Rsdj, M1, Rui, TIDi,TIDinew: text,\nM2, M3, T3, T4, T1, Sigmai: text, Gen, Rep : hash_func\nconst ui_gwn_t1, ui_gwn_rui, gwn_ui_t4, gwn_ui_tidinew,sr1: protocol_id\ninit State := 0\ntransition\n1. State = 0 /\\ Rcv(start) =|>\n% Registration phase\nState' := 1 /\\ A' := new() /\\ R' := new()\n/\\ secret({PWi, BIOi, A', R'}, sr1, Ui)\n/\\ Sigmai' := Gen(BIOi) /\\ RPWi' := xor(H(PWi.Sigmai'.A'), R')\n% Send registration request securely to RA\n/\\ Snd({IDi.RPWi'}_SKuira)\n\n% Receive information securely from RA for SPi\n2. State = 1/\\Rcv({xor(H(IDi'.Kgwnui),xor(H(PWi.Sigmai'.A'),R')).TIDi'}_SKuira)=|>\n% Login phase\nState' := 2\n% Send login request to GWN via public channel\n/\\ Rui' := new() /\\ T1' := new()/\\ M1' := H(IDi.Kgwnui)\n/\\ M2' := xor(M1', Rui') /\\ M3' := H(M2'.T1'.IDi'.TIDi'.Rui')\n/\\ Snd(TIDi'.M2'.M3'.T1')\n% Ui has freshly generated the values T1 and Rui for GWN\n/\\ witness(Ui,GWN,ui_gwn_t1, T1')\n/\\ witness(Ui,GWN,ui_gwn_rui,Rui')\n% Authentication and key agreement phase\n\n% Receive authentication reply from GWN via public channel\n3. State = 2 /\\ Rcv({Rui'.Rgwn'.Rsdj'.IDi.IDsdj.IDgwn.\nH(H(IDsdj.Kgwnsdj))}_H(IDi.Kgwnui).\nxor(TIDinew', H(TIDi'.H(IDi.Kgwnui).T3'.T4')).\nH(H(H(IDi.IDsdj.IDgwn.Rui'.Rgwn'.Rsdj'.\nH(H(IDi.Kgwnui)).H(H(IDsdj.Kgwnsdj))).T3').T4'.Rui').T3'.T4')=|>\n% Ui's acceptance of T4 and TIDinew generated for Ui by GWN\nState' := 3/\\request(GWN,Ui,gwn_ui_t4,T4')/\\request(GWN,Ui,gwn_ui_tidinew,TIDinew')\nend role\n \n\nrole registrationauthority (Ui, RA, GWN, SDj: agent, H : hash_func,\nSKuira : symmetric_key, Snd, Rcv: channel(dy))\nplayed_by RA\ndef=\nlocal State: nat, IDi, IDsdj, IDgwn, PWi, BIOi, RPWi, A, Ai: text,\nR, Kgwnui, Kgwnsdj, Rgwn, Rsdj, T1, M1, Rui, TIDi,TIDinew: text,\nM2, M3, T3, T4, Sigmai: text, Gen, Rep : hash_func\nconst sr2,sr3: protocol_id\ninit State := 0\ntransition\n1. State = 0 /\\ Rcv({IDi.RPWi'}_SKuira) =|>\nState' := 1 /\\ Kgwnui' := new()\n/\\ secret(Kgwnui, sr2, {RA,GWN,Ui})\n/\\ secret(Kgwnsdj, sr3, {RA,GWN,SDj})\n/\\ Ai' := xor(H(IDi.Kgwnui'), RPWi')\n/\\ TIDi' := new()\n/\\ Snd({Ai'.TIDi'}_SKuira)\n\nend role\n\n\nrole gatewaynode (Ui, RA, GWN, SDj: agent, H : hash_func,\nSKuira : symmetric_key, Snd, Rcv: channel(dy))\nplayed_by GWN\ndef=\nlocal State: nat, IDi, IDsdj, IDgwn, PWi, BIOi, RPWi, A: text,\nR, Kgwnui, Kgwnsdj, Rgwn, Rsdj, T1, T2, M1, Rui, TIDi,TIDinew, Ruistar: text,\nM2, M3, M4, M6, M7, M8, M10, M11, M12, T3, T4, Sigmai: text, Gen, Rep : hash_func\nconst gwn_sdj_t2, gwn_sdj_rgwn, sdj_gwn_t3, sdj_gwn_rsdj, ui_gwn_t1, ui_gwn_rui, gwn_ui_t4, gwn_ui_tidinew: protocol_id\ninit State := 0\ntransition\n1. State = 0 /\\ Rcv(TIDi'.xor(H(IDi.Kgwnui), Rui').H(xor(H(IDi.Kgwnui), Rui').T1'.IDi'.TIDi'.Rui').T1') =|>\nState' := 1 /\\ M4' := H(IDi.Kgwnui)\n/\\ request(Ui,GWN,ui_gwn_t1, T1')\n/\\ request(Ui,GWN,ui_gwn_rui,Rui')\n/\\ M2' := new()\n/\\ Ruistar' := xor(M2', M4')\n/\\ Rgwn' := new()\n/\\ T2' := new()\n/\\ M6' := H(IDsdj.Kgwnsdj)\n/\\ M7' := {IDi.IDgwn.Ruistar'.Rgwn.H(M4')}_M6'\n/\\ M8' := H(M6'.T2'.IDi.IDsdj.IDgwn.Rgwn')\n/\\ Snd(M7'.M8'.T2')\n/\\ witness(GWN,SDj,gwn_sdj_t2, T2')\n/\\ witness(GWN,SDj,gwn_sdj_rgwn, Rgwn')\n\n2. State = 1 /\\ Rcv(M10'.M11'.M12'.T3') =|>\nState' := 2 /\\ TIDi' := new() /\\ Rgwn' := new() /\\ Rui' := new() /\\ Rsdj' := new()\t\t\t\t\t\t\t\n/\\ request(SDj,GWN,sdj_gwn_t3, T3')\n/\\ request(SDj,GWN,sdj_gwn_rsdj, Rsdj')\n/\\ T4' := new()\n/\\ TIDinew' := new()\n/\\ Snd({Rui'.Rgwn'.Rsdj'.IDi.IDsdj.IDgwn.\nH(H(IDsdj.Kgwnsdj))}_H(IDi.Kgwnui).\nxor(TIDinew', H(TIDi'.H(IDi.Kgwnui).T3'.T4')).\nH(H(H(IDi.IDsdj.IDgwn.Rui'.Rgwn'.Rsdj'.\nH(H(IDi.Kgwnui)).H(H(IDsdj.Kgwnsdj))).T3').T4'.Rui').T3'.T4')\n/\\ witness(GWN,Ui,gwn_ui_t4, T4')\n/\\ witness(GWN,Ui,gwn_ui_tidinew, TIDinew')\nend role\n\n\n\nrole smartdevice (Ui, RA, GWN, SDj: agent, H : hash_func,\nSKuira : symmetric_key, Snd, Rcv: channel(dy))\nplayed_by SDj\ndef=\nlocal State: nat, IDi, IDsdj, IDgwn, PWi, BIOi, RPWi, A: text,\nR, Kgwnui, Kgwnsdj, Rgwn, Rsdj, T2, M1, Rui, TIDi,TIDinew, Ruistar: text,\nM2, M3, M4, M6, M7, M8, M10, M11, M12, T3, T4, Sigmai: text, Gen, Rep : hash_func\nconst gwn_sdj_t2, gwn_sdj_rgwn, sdj_gwn_t3, sdj_gwn_rsdj: protocol_id\ninit State := 0\ntransition\n1. State = 0 /\\ Rcv({IDi.IDgwn.Ruistar'.Rgwn'.H(M4')}_M6'.M8'.T2') =|>\nState' := 1 /\\ Kgwnsdj' := new()\n/\\ request(GWN,SDj,gwn_sdj_t2, T2')\n/\\ request(GWN,SDj,gwn_sdj_rgwn, Rgwn')\n/\\ Rsdj' := new()\n/\\ T3' := new()\n/\\ M10' := xor(H(H(IDsdj.Kgwnsdj').T3'), Rsdj')\n/\\ M11' := H(H(IDi.IDsdj.IDgwn.Ruistar'.Rgwn'.Rsdj'.H(M4').H(H(IDsdj.Kgwnsdj)).T3'))\n/\\ M12' := H(Rsdj'.Rgwn'.IDsdj.IDgwn.T3')\n/\\ Snd(M10'.M11'.M12'.T3')\n/\\ witness(SDj,GWN,sdj_gwn_t3, T3')\n/\\ witness(SDj,GWN,sdj_gwn_rsdj, Rsdj')\n\nend role\n\nrole session (Ui, RA, GWN, SDj: agent, H: hash_func, SKuira: symmetric_key)\ndef=\nlocal S1, R1, S2, R2, S3, R3, S4, R4: channel (dy)\ncomposition\nuser (Ui, RA, GWN, SDj, H, SKuira, S1, R1)\n/\\ registrationauthority(Ui, RA, GWN, SDj, H, SKuira, S2, R2)\n/\\ gatewaynode (Ui, RA, GWN, SDj, H, SKuira, S3, R3)\n/\\ smartdevice (Ui, RA, GWN, SDj, H, SKuira, S2, R2)\nend role\n\nrole environment()\ndef=\nconst ui, ra, gwn, sdj: agent, h: hash_func, skuira: symmetric_key,\nkgwnui, kgwnsdj, idi, idsnj, idgwn, t1, t2, t3, t4, tidi, tidinew: text,\ngen, rep: hash_func, ui_gwn_t1, ui_gwn_rui, gwn_sdj_t2, gwn_sdj_rgwn,\nsdj_gwn_t3, sdj_gwn_rsdj, sr1, sr2, sr3: protocol_id\nintruder_knowledge ={t1, t2, t3, t4, h, gen, rep}\ncomposition\nsession(ui, ra, gwn, sdj, h, skuira) /\\ session(i, ra, gwn, sdj, h, skuira)\n/\\ session(ui, i, gwn, sdj, h, skuira) /\\ session(ui, ra, i, sdj, h, skuira)\n/\\ session(ui, ra, gwn, i, h, skuira)\nend role\ngoal\nsecrecy_of sr1, sr2, sr3\nauthentication_on ui_gwn_t1, ui_gwn_rui, gwn_sdj_t2\nauthentication_on gwn_sdj_rgwn, sdj_gwn_t3, sdj_gwn_rsdj\nauthentication_on gwn_ui_t4, gwn_ui_tidinew\nend goal\nenvironment()"
    },
    {
        "file": "HLPSL-1/2019202008.hlpsl",
        "incomplete": "%%A temporal-credential-based mutual authentication and key agreement scheme for wireless sensor networks\n%% Roles\n%%\t-user (AGENT : User)\n%%  -generate password (AGENT : Gen)\n%%  -gateway node (AGENT: Gwn)\n%%  -smart device (AGENT :Sensor)\n%%  -session\n%%  -environment\n%%  -goal\n\n____(ROLE_0)____ generate(\n\t____(PARAM_0)____, User, ____(PARAM_2)____, ____(PARAM_3)____: agent,\n\tSND, ____(PARAM_1)____: channel(dy),\n    H: hash_func)\n\nplayed_by Gen\ndef=\nlocal \n\t  ____(VARIABLE_0)____: nat,\n      SKgenu, SKgeng: symmetric_key,\n      PWD: text\n    const sp1, sp2: ____(VARIABLE_1)____\n\ninit  State := 0\ntransition\n\n1. State = 0 /\\ RCV(start) =|> \n State' := 1 /\\ PWD' := new()\n %%Send Password to user through a secure channel\n             /\\ SND({PWD'}_SKgenu)\n %%Send Password to gateway node through a secure channel\n             /\\ SND({PWD'}_SKgeng)\nend ____(ROLE_2)____\n\n%%Role user\nrole user(\n\t____(PARAM_7)____,User,____(PARAM_5)____,____(PARAM_6)____\t: ____(PARAM_4)____,\n\tSND,RCV : channel(dy),\n\tH\t: hash_func\n\t)\n\nplayed_by User def=\n\t\n\tlocal\n\t\tState : ____(VARIABLE_2)____,\n\t\tSKgwnu,SKgenu,SKgeng : symmetric_key,\n\t\tTi,Tdel \t: nat,\n\t\tSId,PWS,UID,PWD,TS1,TS4,TS6,TE,Kgwnu,PWD1,VI,PTC,TC,DID,C,K,PKS,P,C1,PKS1,Kj,KEYij,H1,H2 \t\t: text\n\n\tconst\n\t\tsp2,u_g_ts1,____(VARIABLE_4)____,____(VARIABLE_3)____,____(VARIABLE_6)____,s_u_ts6,s_u_kj:____(VARIABLE_5)____\t\n\n\tinit\n\t\tState:=0\n\n\ttransition\n\n\t%%User Registration\n\n\t\t1. State  = ____(STATE_1)____ /\\ RCV({PWD'}_SKgenu) =|>\n\t\t   State':=1  /\\ UID' := new() /\\ TS1' := new()\n\t\t\t\t\t  /\\ PWD1' := H(PWD')\n\t\t\t\t\t  /\\ VI' := H(TS1'.PWD1')\n\t\t\t\t\t  /\\ SND(TS1'.UID'.VI')\n\t\t\t\t\t  /\\ ____(EVENT_0)____(____(EVENT_1)____,Gwn,u_g_ts1,TS1')\n\n\t\t2. State  = ____(STATE_2)____ /\\ RCV({UID'.H(H(PWD1')).TE'.PTC'}_SKgwnu) =|>\n\t\t   State':= 2 /\\ PWD' := new() /\\ ____(EVENT_3)____({____(EVENT_2)____},sp2, {Gwn})\n\t\t   \t\t\t  /\\ request(____(EVENT_4)____,User,g_u_te,____(EVENT_5)____)\n\t\t   \t\t\t  /\\ H1' := H(H(PWD1'))\n\t\t   \t\t\t  /\\ H2' := H(H(PWD'))\n\t%%Login and authentication phase\n\t\t   \t\t\t  /\\ TC' := xor(PTC',H(PWD))\n\t\t   \t\t\t  /\\ TS4' := new()\n\t\t   \t\t\t  /\\ DID' := xor(UID', H(TC'.TS4'))\n\t\t   \t\t\t  /\\ C' := H(xor(H(UID'.TS4'),TC'))\n\t\t   \t\t\t  /\\ K' := new()\n\t\t   \t\t\t  /\\ PKS' := xor(K',H(TC'.TS4'.0))\n\t\t   \t\t\t  /\\ P' := H(UID'.TE')\n\t\t   \t\t\t  /\\ SND(DID'.C'.PKS'.TS4'.TE'.P')\n\t\t   \t\t\t  /\\ ____(EVENT_6)____(User,Gwn,____(EVENT_7)____,TS4')\n\t\t   \t\t\t  /\\ ____(EVENT_8)____(User,Gwn,____(EVENT_9)____, K')\n\n\t\t3. State  = ____(STATE_4)____ /\\ RCV(SId'.TS6'.C1'.PKS1') =|>\n\t\t   State':= 3 /\\ Kj' := new() /\\ ____(EVENT_11)____(____(EVENT_10)____,User,s_u_ts6,TS6')\n\t\t   \t\t\t  /\\ request(____(EVENT_13)____,User,s_u_kj, ____(EVENT_12)____)\t\n\n\t%%Receive Session key \t   \t\t\t  \n\t\t4. State  = ____(STATE_0)____ /\\ RCV(H(xor(K', Kj'))) =|>\n\t\t   State':= 4 /\\ KEYij' := H(xor(K',Kj'))\n\nend role\n\n%%Role gateway node\nrole gateway(\n\tGen,User,____(PARAM_8)____,Sensor\t: ____(PARAM_10)____,\n\t____(PARAM_11)____,____(PARAM_9)____ : channel(dy),\n\tH \t: hash_func\n%\tKgwnu, Kgwns\t: public_key,\n\t)\n\nplayed_by Gwn def=\n\n\tlocal\n\t\t____(VARIABLE_13)____ : nat,\n\t\tSKgwnu,SKgenu,SKgeng : symmetric_key,\n\t\tTdel,Tchckgwn,Ti,Tgwn\t: nat,\n\t\tPWS,SId,UID,PWD,TS4,TS6,TS5,TS3,TS2,TE,TS1,Kgwns,Kgwnu,VI,VI1,P,TC,PTC,VI2,VI3,TC1,REG,P1,DID,C,PKS,C1,K,DIDgwn,Cgwn,PKSgwn,C1j,PKS1,Kj,KEYij\t: text\n\n\n\tconst\n\t\t____(VARIABLE_10)____,____(VARIABLE_12)____,____(VARIABLE_11)____,g_u_te,u_g_ts1,____(VARIABLE_7)____,s_g_ts2,____(VARIABLE_9)____,u_g_ts4,u_g_k,s_g_ts6,s_g_kj:____(VARIABLE_8)____\n\n\tinit\n\t\tState := 0\n\n\ttransition\n\n\t%% REceive request for registration from user\n\n\t\t1. State  = 0 /\\  RCV({PWD'}_SKgeng) =|>\n\t\t   State':= 1 /\\ TE' := new()\n\n\t\t2. State  = ____(STATE_3)____ /\\ RCV(TS1'.UID'.VI') =|>\n\t\t   State':= 2 /\\ PWD' := new() /\\ VI1' := H(TS1'.H(PWD'))\n\t\t   \t\t\t  /\\ TE' := new()\n\t\t   \t\t\t  /\\ P' := H(UID'.TE')\n\t\t   \t\t\t  /\\ TC' := H(Kgwnu.P'.TE')\n\t\t   \t\t\t  /\\ PTC' := xor(TC', H(PWD'))\n\t\t   \t\t\t  /\\ ____(EVENT_15)____({____(EVENT_14)____}, sp2, {Gwn})\n\t\t   \t\t\t  /\\ SND({UID'.H(H(PWD')).TE'.PTC'}_SKgwnu)\n\t\t   \t\t\t  /\\ ____(EVENT_16)____(Gwn,User,____(EVENT_17)____,TE') \n\t\t   \t\t\t  /\\ request(____(EVENT_19)____,____(EVENT_18)____,u_g_ts1,TS1')\n\n    %%Receive request for registration from Sensor\n\t\t3. State  = 2 /\\ RCV(SId'.TS2'.VI2') =|>\n\t\t   State':= 3 /\\ PWS' := new() /\\ secret({____(EVENT_20)____}, ____(EVENT_21)____, {Sensor, Gwn})\n\t\t   \t \t\t  /\\ VI3' := H(TS2'.H(PWS'))\n\t\t   \t \t\t  /\\ TC1' := H(Kgwns.SId')\n\t\t   \t \t\t  /\\ TS3' := new()\n\t\t   \t \t\t  /\\ REG' := xor(H(H(PWS').TS3'),TC1')\n\t\t   \t \t\t  /\\ SND(TS3'.REG')\n\t\t   \t \t\t  /\\ ____(EVENT_23)____({Kgwns}, ____(EVENT_22)____, {Gwn})\n\t\t   \t \t\t  /\\ ____(EVENT_24)____(____(EVENT_25)____,Sensor,g_s_ts3,TS3')\n\t\t   \t \t\t  /\\ request(____(EVENT_27)____,Gwn,s_g_ts2,____(EVENT_26)____)\n    %%Login and authentication phase\n\t\t4. State  = ____(STATE_5)____ /\\ RCV(DID'.C'.PKS'.TS4'.TE'.P') =|>\n\t\t   State':= 4 /\\ SId' := new() /\\ UID' := xor(DID',H(H(inv(Kgwnu).P'.TE').TS4')) \n\t\t   \t\t\t  /\\ TC' := H(Kgwnu.UID')\n\t\t   \t\t\t  /\\ C1' := H(xor(H(UID'.TS4'),TC'))\n\t\t   \t\t\t  /\\ K' := xor(PKS', H(TC'.TS4'.0))\n\t\t   \t\t\t  /\\ TC1' := H(Kgwns.SId') \n\t\t   \t\t\t  /\\ TS5' := new()\n\t\t   \t\t\t  /\\ DIDgwn' := xor(UID',H(DID'.TC1'.TS5'))\n\t\t   \t\t\t  /\\ Cgwn' := H(UID'.TC1'.TS5')\n\t\t   \t\t\t  /\\ PKSgwn' := xor(K',H(TC1'.TS5'))\n\t\t   \t\t\t  /\\ SND(TS5'.DID'.DIDgwn'.Cgwn'.PKSgwn')\n\t\t   \t\t\t  /\\ ____(EVENT_29)____(____(EVENT_28)____,Sensor,g_s_ts5,TS5')\n\t\t   \t\t\t  /\\ request(____(EVENT_31)____,Gwn,____(EVENT_30)____,TS4')\n\t\t   \t\t\t  /\\ ____(EVENT_33)____(User,Gwn,u_g_k, ____(EVENT_32)____)\n\n    %% send session key via public channel to user and sensor\n\t\t5. State  = ____(STATE_6)____ /\\ RCV(SId'.TS6'.C1'.PKS1') =|>\n\t\t   State':= 5 /\\ K' := new() /\\ Kj' := xor(PKS1', H(K'.TS6'))\n\t\t   \t\t\t  /\\ KEYij' := H(xor(K',Kj'))\n\t\t   \t\t\t  /\\ SND(KEYij)\n\t\t   \t\t\t  /\\ request(Sensor,____(EVENT_34)____,s_g_ts6, ____(EVENT_35)____)\n\t\t   \t\t\t  /\\ ____(EVENT_36)____(Sensor,Gwn,____(EVENT_37)____, Kj')\n\nend role\n\n%%Sensor role\n\nrole sensor(\n\tGen,____(PARAM_13)____,Gwn,____(PARAM_15)____\t: agent,\n\t____(PARAM_12)____,____(PARAM_14)____ : channel(dy),\n\tH \t: hash_func\n\t)\n\nplayed_by Sensor def=\n\n\tlocal\n\t\tState : nat,\n\t\tTgwn,Tdel,Tchckj: nat,\n\t\tPWS,SId,Kgwns,TS6,TS5,TS3,TS2,TE,VI,TC1,DID,DIDgwn,Cgwn,PKSgwn,IDi,Cgwn1,Ki,Kj,C1,PKS1,REG,IDj,TCj,KEYij \t: text\n\n\tconst\n\t\tsp3,sp4,s_g_ts2,____(VARIABLE_17)____,____(VARIABLE_14)____,s_u_kj,____(VARIABLE_16)____:____(VARIABLE_15)____\n\n\tinit\n\t\tState := 2\n\n\ttransition\n\n\t%%Sensor Node registration\n\t\t\n\t\t1. State  = 2 /\\ RCV(start) =|> \n\t\t   State':= 3 /\\ TS2' := new() /\\ SId' := new() /\\ PWS' := new() \n\t\t   \t\t\t  /\\ VI' := H(TS2'.H(PWS'))\n\t\t   \t\t\t  /\\ SND(SId'.TS2'.VI')\n\t\t   \t\t\t  /\\ secret({____(EVENT_38)____}, sp3, {____(EVENT_39)____, Gwn})\n\t\t   \t\t\t  /\\ witness(____(EVENT_40)____,Gwn,____(EVENT_41)____,TS2')\n\n\t\t2. State  = 3 /\\ RCV(TS3'.REG') =|>\n\t\t   State':= 4 /\\ PWS' := new() /\\ secret({____(EVENT_43)____}, sp4, {____(EVENT_42)____})\n\t\t   \t\t\t  /\\ TC1' := xor(REG', H(H(PWS').TS3')) \n\t\t   \t\t\t  /\\ ____(EVENT_44)____(Gwn,____(EVENT_45)____,g_s_ts3,TS3')\n\n    %%Authentication between gateway and sensor\n\t\t3. State  = 4 /\\ RCV(TS5'.DID'.DIDgwn'.Cgwn'.PKSgwn') =|>\n\t\t   State':= 5 /\\ SId' := new() /\\ TCj' := new() /\\ IDj' := new() /\\ TC1' := new() /\\ IDi' := xor(DIDgwn', H(DID'.TC1'.TS5'))\n\t\t   \t\t\t  /\\ Cgwn1' := H(IDj'.TCj'.TS5')\n\t\t   \t\t\t  /\\ Ki' := xor(PKSgwn',H(TC1'.TS5'))\n\t\t   \t\t\t  /\\ TS6' := new()\n\t\t   \t\t\t  /\\ Kj' := new()\n\t\t   \t\t\t  /\\ C1' := H(Kj'.IDi'.SId'.TS6')\n\t\t   \t\t\t  /\\ PKS1' := xor(Kj',H(Ki'.TS6'))\n\t\t   \t\t\t  /\\ SND(SId'.TS6'.C1'.PKS1')\n\t\t   \t\t\t  /\\ witness(____(EVENT_46)____,User,s_u_ts6,____(EVENT_47)____)\n\t\t   \t\t\t  /\\ ____(EVENT_48)____(____(EVENT_49)____,User,s_u_kj,Kj')\n\n    %%Receive session key from gateway through public channel\n\t\t4. State  = 5 /\\ RCV(H(xor(Ki', Kj'))) =|>\n\t\t   State' := 6 /\\ TS6' := new() /\\ KEYij' := H(xor(Ki', Kj'))\n\t\t              /\\ witness(Sensor,____(EVENT_51)____,s_g_ts6, ____(EVENT_50)____)\n\t\t              /\\ witness(____(EVENT_53)____,Gwn,____(EVENT_52)____, Kj')\nend role\n\n%%Sensor role\nrole session(\n\t____(PARAM_17)____,____(PARAM_18)____,Gwn,Sensor : ____(PARAM_16)____,\n\tH:hash_func)\n\n\tdef=\n\t\t\n\t\tlocal \n\t\t\t____(VARIABLE_18)____,RCVU,SNDG,RCVG,SNDS,____(VARIABLE_19)____: channel (____(VARIABLE_20)____)\n\n\t\tcomposition\n\t\t\tuser(Gen,User,Gwn,Sensor,SNDU,RCVU,H)\n  \t\t\t/\\ gateway(Gen,User,Gwn,Sensor,SNDG,RCVG,H)\n  \t\t\t/\\ sensor(Gen,User,Gwn,Sensor,SNDS,RCVS,H)\nend role\n\n%%Role for environment\nrole environment()\n\t\n\tdef=\n\n\t\tconst \n\t\t\ta,____(VARIABLE_22)____,____(VARIABLE_21)____,d: agent,\n\t\t\tu_g_ts4,u_g_k,sp2,g_u_te,u_g_ts1,g_s_ts5,s_g_ts6,sp3,sp4,s_g_ts2,g_s_ts3,s_u_ts6,s_u_kj,s_g_kj:protocol_id,\n\t\t\th:hash_func,\n\t\t\tt1,t2,t3:text\n\t\t\t%Kgwnu,Kgwns:public_key\n\n\n\tintruder_knowledge = {a,b,c,t1,t2,t3}\n\n\tcomposition\n\t\t   session(a,b,c,d,h)\n\t\t/\\ session(a,i,c,d,h) \n\t\t/\\ session(a,b,i,d,h)\n\t\t/\\ session(a,b,c,i,h)\n\nend role\n\ngoal\n\t____(GOAL_55)____ sp2, ____(GOAL_54)____, sp4\n\n\tauthentication_on ____(GOAL_57)____, ____(GOAL_56)____, u_g_k\n\t____(GOAL_59)____ g_u_te, ____(GOAL_58)____, g_s_ts5\n\tauthentication_on s_g_ts2, ____(GOAL_61)____, ____(GOAL_60)____, ____(GOAL_62)____, s_g_kj\nend goal\n\nenvironment()",
        "complete:": "%%A temporal-credential-based mutual authentication and key agreement scheme for wireless sensor networks\n%% Roles\n%%\t-user (AGENT : User)\n%%  -generate password (AGENT : Gen)\n%%  -gateway node (AGENT: Gwn)\n%%  -smart device (AGENT :Sensor)\n%%  -session\n%%  -environment\n%%  -goal\n\nrole generate(\n\tGen, User, Gwn, Sensor: agent,\n\tSND, RCV: channel(dy),\n    H: hash_func)\n\nplayed_by Gen\ndef=\nlocal \n\t  State: nat,\n      SKgenu, SKgeng: symmetric_key,\n      PWD: text\n    const sp1, sp2: protocol_id\n\ninit  State := 0\ntransition\n\n1. State = 0 /\\ RCV(start) =|> \n State' := 1 /\\ PWD' := new()\n %%Send Password to user through a secure channel\n             /\\ SND({PWD'}_SKgenu)\n %%Send Password to gateway node through a secure channel\n             /\\ SND({PWD'}_SKgeng)\nend role\n\n%%Role user\nrole user(\n\tGen,User,Gwn,Sensor\t: agent,\n\tSND,RCV : channel(dy),\n\tH\t: hash_func\n\t)\n\nplayed_by User def=\n\t\n\tlocal\n\t\tState : nat,\n\t\tSKgwnu,SKgenu,SKgeng : symmetric_key,\n\t\tTi,Tdel \t: nat,\n\t\tSId,PWS,UID,PWD,TS1,TS4,TS6,TE,Kgwnu,PWD1,VI,PTC,TC,DID,C,K,PKS,P,C1,PKS1,Kj,KEYij,H1,H2 \t\t: text\n\n\tconst\n\t\tsp2,u_g_ts1,g_u_te,u_g_ts4,u_g_k,s_u_ts6,s_u_kj:protocol_id\t\n\n\tinit\n\t\tState:=0\n\n\ttransition\n\n\t%%User Registration\n\n\t\t1. State  = 0 /\\ RCV({PWD'}_SKgenu) =|>\n\t\t   State':=1  /\\ UID' := new() /\\ TS1' := new()\n\t\t\t\t\t  /\\ PWD1' := H(PWD')\n\t\t\t\t\t  /\\ VI' := H(TS1'.PWD1')\n\t\t\t\t\t  /\\ SND(TS1'.UID'.VI')\n\t\t\t\t\t  /\\ witness(User,Gwn,u_g_ts1,TS1')\n\n\t\t2. State  = 1 /\\ RCV({UID'.H(H(PWD1')).TE'.PTC'}_SKgwnu) =|>\n\t\t   State':= 2 /\\ PWD' := new() /\\ secret({Kgwnu},sp2, {Gwn})\n\t\t   \t\t\t  /\\ request(Gwn,User,g_u_te,TE')\n\t\t   \t\t\t  /\\ H1' := H(H(PWD1'))\n\t\t   \t\t\t  /\\ H2' := H(H(PWD'))\n\t%%Login and authentication phase\n\t\t   \t\t\t  /\\ TC' := xor(PTC',H(PWD))\n\t\t   \t\t\t  /\\ TS4' := new()\n\t\t   \t\t\t  /\\ DID' := xor(UID', H(TC'.TS4'))\n\t\t   \t\t\t  /\\ C' := H(xor(H(UID'.TS4'),TC'))\n\t\t   \t\t\t  /\\ K' := new()\n\t\t   \t\t\t  /\\ PKS' := xor(K',H(TC'.TS4'.0))\n\t\t   \t\t\t  /\\ P' := H(UID'.TE')\n\t\t   \t\t\t  /\\ SND(DID'.C'.PKS'.TS4'.TE'.P')\n\t\t   \t\t\t  /\\ witness(User,Gwn,u_g_ts4,TS4')\n\t\t   \t\t\t  /\\ witness(User,Gwn,u_g_k, K')\n\n\t\t3. State  = 2 /\\ RCV(SId'.TS6'.C1'.PKS1') =|>\n\t\t   State':= 3 /\\ Kj' := new() /\\ request(Sensor,User,s_u_ts6,TS6')\n\t\t   \t\t\t  /\\ request(Sensor,User,s_u_kj, Kj')\t\n\n\t%%Receive Session key \t   \t\t\t  \n\t\t4. State  = 3 /\\ RCV(H(xor(K', Kj'))) =|>\n\t\t   State':= 4 /\\ KEYij' := H(xor(K',Kj'))\n\nend role\n\n%%Role gateway node\nrole gateway(\n\tGen,User,Gwn,Sensor\t: agent,\n\tSND,RCV : channel(dy),\n\tH \t: hash_func\n%\tKgwnu, Kgwns\t: public_key,\n\t)\n\nplayed_by Gwn def=\n\n\tlocal\n\t\tState : nat,\n\t\tSKgwnu,SKgenu,SKgeng : symmetric_key,\n\t\tTdel,Tchckgwn,Ti,Tgwn\t: nat,\n\t\tPWS,SId,UID,PWD,TS4,TS6,TS5,TS3,TS2,TE,TS1,Kgwns,Kgwnu,VI,VI1,P,TC,PTC,VI2,VI3,TC1,REG,P1,DID,C,PKS,C1,K,DIDgwn,Cgwn,PKSgwn,C1j,PKS1,Kj,KEYij\t: text\n\n\n\tconst\n\t\tsp2,sp3,sp4,g_u_te,u_g_ts1,g_s_ts3,s_g_ts2,g_s_ts5,u_g_ts4,u_g_k,s_g_ts6,s_g_kj:protocol_id\n\n\tinit\n\t\tState := 0\n\n\ttransition\n\n\t%% REceive request for registration from user\n\n\t\t1. State  = 0 /\\  RCV({PWD'}_SKgeng) =|>\n\t\t   State':= 1 /\\ TE' := new()\n\n\t\t2. State  = 1 /\\ RCV(TS1'.UID'.VI') =|>\n\t\t   State':= 2 /\\ PWD' := new() /\\ VI1' := H(TS1'.H(PWD'))\n\t\t   \t\t\t  /\\ TE' := new()\n\t\t   \t\t\t  /\\ P' := H(UID'.TE')\n\t\t   \t\t\t  /\\ TC' := H(Kgwnu.P'.TE')\n\t\t   \t\t\t  /\\ PTC' := xor(TC', H(PWD'))\n\t\t   \t\t\t  /\\ secret({Kgwnu}, sp2, {Gwn})\n\t\t   \t\t\t  /\\ SND({UID'.H(H(PWD')).TE'.PTC'}_SKgwnu)\n\t\t   \t\t\t  /\\ witness(Gwn,User,g_u_te,TE') \n\t\t   \t\t\t  /\\ request(User,Gwn,u_g_ts1,TS1')\n\n    %%Receive request for registration from Sensor\n\t\t3. State  = 2 /\\ RCV(SId'.TS2'.VI2') =|>\n\t\t   State':= 3 /\\ PWS' := new() /\\ secret({PWS}, sp3, {Sensor, Gwn})\n\t\t   \t \t\t  /\\ VI3' := H(TS2'.H(PWS'))\n\t\t   \t \t\t  /\\ TC1' := H(Kgwns.SId')\n\t\t   \t \t\t  /\\ TS3' := new()\n\t\t   \t \t\t  /\\ REG' := xor(H(H(PWS').TS3'),TC1')\n\t\t   \t \t\t  /\\ SND(TS3'.REG')\n\t\t   \t \t\t  /\\ secret({Kgwns}, sp4, {Gwn})\n\t\t   \t \t\t  /\\ witness(Gwn,Sensor,g_s_ts3,TS3')\n\t\t   \t \t\t  /\\ request(Sensor,Gwn,s_g_ts2,TS2')\n    %%Login and authentication phase\n\t\t4. State  = 3 /\\ RCV(DID'.C'.PKS'.TS4'.TE'.P') =|>\n\t\t   State':= 4 /\\ SId' := new() /\\ UID' := xor(DID',H(H(inv(Kgwnu).P'.TE').TS4')) \n\t\t   \t\t\t  /\\ TC' := H(Kgwnu.UID')\n\t\t   \t\t\t  /\\ C1' := H(xor(H(UID'.TS4'),TC'))\n\t\t   \t\t\t  /\\ K' := xor(PKS', H(TC'.TS4'.0))\n\t\t   \t\t\t  /\\ TC1' := H(Kgwns.SId') \n\t\t   \t\t\t  /\\ TS5' := new()\n\t\t   \t\t\t  /\\ DIDgwn' := xor(UID',H(DID'.TC1'.TS5'))\n\t\t   \t\t\t  /\\ Cgwn' := H(UID'.TC1'.TS5')\n\t\t   \t\t\t  /\\ PKSgwn' := xor(K',H(TC1'.TS5'))\n\t\t   \t\t\t  /\\ SND(TS5'.DID'.DIDgwn'.Cgwn'.PKSgwn')\n\t\t   \t\t\t  /\\ witness(Gwn,Sensor,g_s_ts5,TS5')\n\t\t   \t\t\t  /\\ request(User,Gwn,u_g_ts4,TS4')\n\t\t   \t\t\t  /\\ request(User,Gwn,u_g_k, K')\n\n    %% send session key via public channel to user and sensor\n\t\t5. State  = 4 /\\ RCV(SId'.TS6'.C1'.PKS1') =|>\n\t\t   State':= 5 /\\ K' := new() /\\ Kj' := xor(PKS1', H(K'.TS6'))\n\t\t   \t\t\t  /\\ KEYij' := H(xor(K',Kj'))\n\t\t   \t\t\t  /\\ SND(KEYij)\n\t\t   \t\t\t  /\\ request(Sensor,Gwn,s_g_ts6, TS6')\n\t\t   \t\t\t  /\\ request(Sensor,Gwn,s_g_kj, Kj')\n\nend role\n\n%%Sensor role\n\nrole sensor(\n\tGen,User,Gwn,Sensor\t: agent,\n\tSND,RCV : channel(dy),\n\tH \t: hash_func\n\t)\n\nplayed_by Sensor def=\n\n\tlocal\n\t\tState : nat,\n\t\tTgwn,Tdel,Tchckj: nat,\n\t\tPWS,SId,Kgwns,TS6,TS5,TS3,TS2,TE,VI,TC1,DID,DIDgwn,Cgwn,PKSgwn,IDi,Cgwn1,Ki,Kj,C1,PKS1,REG,IDj,TCj,KEYij \t: text\n\n\tconst\n\t\tsp3,sp4,s_g_ts2,g_s_ts3,s_u_ts6,s_u_kj,s_g_kj:protocol_id\n\n\tinit\n\t\tState := 2\n\n\ttransition\n\n\t%%Sensor Node registration\n\t\t\n\t\t1. State  = 2 /\\ RCV(start) =|> \n\t\t   State':= 3 /\\ TS2' := new() /\\ SId' := new() /\\ PWS' := new() \n\t\t   \t\t\t  /\\ VI' := H(TS2'.H(PWS'))\n\t\t   \t\t\t  /\\ SND(SId'.TS2'.VI')\n\t\t   \t\t\t  /\\ secret({PWS}, sp3, {Sensor, Gwn})\n\t\t   \t\t\t  /\\ witness(Sensor,Gwn,s_g_ts2,TS2')\n\n\t\t2. State  = 3 /\\ RCV(TS3'.REG') =|>\n\t\t   State':= 4 /\\ PWS' := new() /\\ secret({Kgwns}, sp4, {Gwn})\n\t\t   \t\t\t  /\\ TC1' := xor(REG', H(H(PWS').TS3')) \n\t\t   \t\t\t  /\\ request(Gwn,Sensor,g_s_ts3,TS3')\n\n    %%Authentication between gateway and sensor\n\t\t3. State  = 4 /\\ RCV(TS5'.DID'.DIDgwn'.Cgwn'.PKSgwn') =|>\n\t\t   State':= 5 /\\ SId' := new() /\\ TCj' := new() /\\ IDj' := new() /\\ TC1' := new() /\\ IDi' := xor(DIDgwn', H(DID'.TC1'.TS5'))\n\t\t   \t\t\t  /\\ Cgwn1' := H(IDj'.TCj'.TS5')\n\t\t   \t\t\t  /\\ Ki' := xor(PKSgwn',H(TC1'.TS5'))\n\t\t   \t\t\t  /\\ TS6' := new()\n\t\t   \t\t\t  /\\ Kj' := new()\n\t\t   \t\t\t  /\\ C1' := H(Kj'.IDi'.SId'.TS6')\n\t\t   \t\t\t  /\\ PKS1' := xor(Kj',H(Ki'.TS6'))\n\t\t   \t\t\t  /\\ SND(SId'.TS6'.C1'.PKS1')\n\t\t   \t\t\t  /\\ witness(Sensor,User,s_u_ts6,TS6')\n\t\t   \t\t\t  /\\ witness(Sensor,User,s_u_kj,Kj')\n\n    %%Receive session key from gateway through public channel\n\t\t4. State  = 5 /\\ RCV(H(xor(Ki', Kj'))) =|>\n\t\t   State' := 6 /\\ TS6' := new() /\\ KEYij' := H(xor(Ki', Kj'))\n\t\t              /\\ witness(Sensor,Gwn,s_g_ts6, TS6')\n\t\t              /\\ witness(Sensor,Gwn,s_g_kj, Kj')\nend role\n\n%%Sensor role\nrole session(\n\tGen,User,Gwn,Sensor : agent,\n\tH:hash_func)\n\n\tdef=\n\t\t\n\t\tlocal \n\t\t\tSNDU,RCVU,SNDG,RCVG,SNDS,RCVS: channel (dy)\n\n\t\tcomposition\n\t\t\tuser(Gen,User,Gwn,Sensor,SNDU,RCVU,H)\n  \t\t\t/\\ gateway(Gen,User,Gwn,Sensor,SNDG,RCVG,H)\n  \t\t\t/\\ sensor(Gen,User,Gwn,Sensor,SNDS,RCVS,H)\nend role\n\n%%Role for environment\nrole environment()\n\t\n\tdef=\n\n\t\tconst \n\t\t\ta,b,c,d: agent,\n\t\t\tu_g_ts4,u_g_k,sp2,g_u_te,u_g_ts1,g_s_ts5,s_g_ts6,sp3,sp4,s_g_ts2,g_s_ts3,s_u_ts6,s_u_kj,s_g_kj:protocol_id,\n\t\t\th:hash_func,\n\t\t\tt1,t2,t3:text\n\t\t\t%Kgwnu,Kgwns:public_key\n\n\n\tintruder_knowledge = {a,b,c,t1,t2,t3}\n\n\tcomposition\n\t\t   session(a,b,c,d,h)\n\t\t/\\ session(a,i,c,d,h) \n\t\t/\\ session(a,b,i,d,h)\n\t\t/\\ session(a,b,c,i,h)\n\nend role\n\ngoal\n\tsecrecy_of sp2, sp3, sp4\n\n\tauthentication_on u_g_ts4, u_g_ts1, u_g_k\n\tauthentication_on g_u_te, g_s_ts3, g_s_ts5\n\tauthentication_on s_g_ts2, s_u_kj, s_u_ts6, s_g_ts6, s_g_kj\nend goal\n\nenvironment()"
    },
    {
        "file": "HLPSL-1/AAAMobileIP.hlpsl",
        "incomplete": "%% PROTOCOL: AAA Mobile IP\n%%\n%% PURPOSE:\n%%   This document specifies a Diameter application that allows a Diameter\n%%   server to authenticate, authorise and collect accounting information\n%%   for Mobile IPv4 services rendered to a mobile node.\n%%\n%% REFERENCE:\n%%   \\begin{itemize}\n%%   \\item \\cite{mip4-rfc3012bis,aaa-diameter-mobileip}\n%%   \\end{itemize}\n%%\n%% MODELER:\n%%   \\begin{itemize}\n%%   \\item Haykal Tej, Siemens CT IC 3, 2003\n%%   \\item Paul Hankes Drielsma, Information Security Group,  ETH Z\\\"{u}rich, December 2003\n%%   \\item Sebastian M\\\"odersheim, Information Security Group, ETH Z\\\"{u}rich, January 2004\n%%   \\item Luca Compagna, AI-Lab DIST, University of Genova, December 2004\n%%   \\end{itemize}\n%% ALICE_BOB:\n%% \\begin{verbatim}\n%% 1. FA   -> MN:   FA,N_FA\n%% 2. MN   -> FA:   N_FA,MN,AAAH,\n%%                  {N_FA,MN,AAAH}_K_MnAAAH\n%% 3. FA   -> AAAL: N_FA,MN,AAAH,\n%%                  {N_FA,MN,AAAH}_K_MnAAAH\n%% 4. AAAL -> AAAH: N_FA,MN,AAAH,\n%%                  {N_FA,MN,AAAH}_K_MnAAAH      \n%% 5. AAAH -> HA:   MN,\n%%                  {K_MnHa,K_FaHa}_KAAAHHa,\n%%                  {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                  {MN,\n%%                   {K_MnHa,K_FaHa}_KAAAHHa,\n%%                   {K_MnFa,K_MnHa}_K_MnAAAH\n%%                  }_K_AAAHHa\n%% 6. HA   -> AAAH: {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                  {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa,\n%%                  {{K_MnFa,K_MnHa}_K_MnAAAH,\n%%                   {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa\n%%                  }_K_AAAHHa\n%% 7. AAAH -> AAAL: N_FA,\n%%                  {K_MnFa,K_FaHa}_K_AAAHAAAL,\n%%                  {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                  {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa,\n%%                  {N_FA,\n%%                   {K_MnFa,K_FaHa}_K_AAAHAAAL,\n%%                   {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                   {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa\n%%                  }_K_AAAHAAAL\n%% 8. AAAL -> FA:   N_FA,\n%%                  {K_MnFa,K_FaHa}_K_FaAAAL,\n%%                  {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                  {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa,\n%%                  {N_FA,\n%%                   {K_MnFa,K_FaHa}_K_FaAAAL,\n%%                   {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                   {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa\n%%                  }_K_FaAAAL\n%% 9. FA   -> MN:   {K_MnFa,K_FaHa}_K_FaAAAL,\n%%                  {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                  {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa\n%% \\end{verbatim}\n%% PROBLEMS: 7\n%% CLASSIFICATION: G1, G7, G10, G12\n%% ATTACKS:\n%% \\begin{verbatim}\n%% i      -> (mn,3): fa,fa\n%% (mn,3) -> i:      fa,mn,aaah,{fa,mn,aaah}k_mn_aaah\n%% i      -> (mn,3): {fa,mn,aaah}k_mn_aaah,{{fa,mn,aaah}k_mn_aaah}(mn,aaah)\n%% \\end{verbatim}\n%% In this type-flaw attack, the intruder replays the message \n%% \\verb+{fa,mn,aaah}k_mn_aaah+  to the mobile node, which expects to receive\n%% a message of the form \\verb+{fa,NewKey}k_mn_aaah+ where NewKey is the\n%% new key, which is thus matched with the pair of agent names \\verb+mn,aah+. \n%% Since the intruder knows these two agent names, he can also produce a \n%% message encrypted with this new key as required.\n%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% \t\n%%  HLPSL:\n\nrole aaa_MIP_MN (MN, AAAH, FA : ____(PARAM_2)____,\n                 ____(PARAM_0)____, ____(PARAM_1)____     : channel(dy),\n                 K_MnAAAH     : symmetric_key)\nplayed_by MN\ndef=\n\n  local  State         : ____(VARIABLE_0)____,\n\t K_MnFa,K_MnHa : symmetric_key\n\n  init   State := 0\n\n  transition\n\n   1. State = ____(STATE_0)____\n      /\\ ____(MESSAGE_18)____(FA.FA)\n      =|> \n      State' := 1\n      /\\  Snd(____(MESSAGE_19)____.{FA.MN.AAAH}_K_MnAAAH) \n\n   2. State = ____(STATE_2)____\n      /\\ Rcv( {K_MnFa'.K_MnHa'}_K_MnAAAH.\n             {{K_MnFa'.K_MnHa'}_K_MnAAAH}_K_MnHa') \n      =|>  \n      State' := 2 \n      /\\ wrequest(MN,AAAH,k_mnha2,K_MnHa')\n      /\\ wrequest(MN,AAAH,k_mnfa2,K_MnFa')\n\nend role\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nrole aaa_MIP_FA (____(PARAM_5)____,AAAL,____(PARAM_3)____,____(PARAM_6)____: agent,\n                 ____(PARAM_4)____, Rcv: channel(dy),\n                 K_FaAAAL: symmetric_key)\nplayed_by FA\ndef=\n\n  local\n    State              : nat,\n    K_MnFa, K_FaHa     : symmetric_key,\n    SignedRegReq       : {agent.(agent.agent)}_symmetric_key,\n    KeyMnHaKeyMnFa     : {symmetric_key.symmetric_key}_symmetric_key,\n    SignKeyMnHaKeyMnFa : \n         {{symmetric_key.symmetric_key}_symmetric_key}_symmetric_key\n\n  init State := 0\n\n  transition\n\n   1. State = 0\n      /\\ ____(MESSAGE_20)____(start)\n      =|> \n      State' := 1\n      /\\ Snd(____(MESSAGE_21)____) \n\n   2. State = ____(STATE_3)____\n      /\\ ____(MESSAGE_22)____(FA.MN.AAAH.SignedRegReq')\n      =|> \n      State' := 2\n      /\\ Snd(____(MESSAGE_23)____) \n\t\n   3. State = ____(STATE_1)____\n      /\\ Rcv( FA.{K_MnFa'.K_FaHa'}_K_FaAAAL.\n              KeyMnHaKeyMnFa'.SignKeyMnHaKeyMnFa'.\n              {FA.{K_MnFa'.K_FaHa'}_K_FaAAAL.\n               KeyMnHaKeyMnFa'.SignKeyMnHaKeyMnFa'}_K_FaAAAL)\n      =|>\n      State' := 3\n      /\\ Snd(____(MESSAGE_24)____) \n      /\\ wrequest(FA,AAAH,k_faha1,K_FaHa')\n      /\\ wrequest(FA,AAAH,k_mnfa1,K_MnFa')\n\nend role\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nrole ____(ROLE_3)____ (AAAL,____(PARAM_10)____,____(PARAM_7)____,MN: agent,\n                  ____(PARAM_8)____, Rcv: channel(____(PARAM_9)____),\n                  K_FaAAAL,K_AAAHAAAL: symmetric_key)\nplayed_by AAAL\ndef=\n\n  local\n    State                : nat,\n    K_MnFa,K_FaHa        : symmetric_key,\n    SignedRegReq         : {agent.(agent.agent)}_symmetric_key,\n    KeyMnFaKeyMnHa       : {symmetric_key.symmetric_key}_symmetric_key,\n    SignedKeyMnFaKeyMnHa : \n           {{symmetric_key.symmetric_key}_symmetric_key}_symmetric_key\n\n  init State := 0\n  \n  transition\n\n   1. State = 0\n      /\\ Rcv(____(MESSAGE_25)____)\n      =|> \n      State' := 1 \n      /\\ Snd(____(MESSAGE_26)____) \n\n   2. State = ____(STATE_4)____\n      /\\ Rcv( FA.{K_MnFa'.K_FaHa'}_K_AAAHAAAL.\n              KeyMnFaKeyMnHa'.SignedKeyMnFaKeyMnHa'.\n              {FA.{K_MnFa'.K_FaHa'}_K_AAAHAAAL.\n               KeyMnFaKeyMnHa'.SignedKeyMnFaKeyMnHa'}_K_AAAHAAAL)\n      =|>\n      State' := 2\n      /\\ Snd( FA.{K_MnFa'.K_FaHa'}_K_FaAAAL.\n                 KeyMnFaKeyMnHa'.SignedKeyMnFaKeyMnHa'.\n             {FA.{K_MnFa'.K_FaHa'}_K_FaAAAL.\n                 KeyMnFaKeyMnHa'.SignedKeyMnFaKeyMnHa'}_K_FaAAAL)\n\nend role\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nrole aaa_MIP_AAAH (AAAH,____(PARAM_12)____,____(PARAM_11)____,____(PARAM_14)____,____(PARAM_13)____ : agent,\n           Snd, Rcv : channel(dy),\n           K_MnAAAH,\n           K_AAAHAAAL,\n           KAAAHHa : symmetric_key)\nplayed_by AAAH\ndef=\n\n  local  ____(VARIABLE_1)____                : nat,\n\t K_FaHa,K_MnHa,K_MnFa : symmetric_key\n\n  const  secFAHA, ____(VARIABLE_3)____, ____(VARIABLE_2)____   : protocol_id\n\n  init   State := 0\n\n  transition\n\n   1. State   = 0\n      /\\ ____(MESSAGE_27)____(FA.MN.AAAH.{FA.MN.AAAH}_K_MnAAAH)\n      =|> \n      State' := 1\n      /\\ K_MnHa' := new()\n      /\\ K_MnFa' := new()\n      /\\ K_FaHa' := new()\n      /\\ Snd( MN.{K_MnHa'.K_FaHa'}_KAAAHHa.\n                 {K_MnFa'.K_MnHa'}_K_MnAAAH.\n                 {MN.{K_MnHa'.K_FaHa'}_KAAAHHa.\n                     {K_MnFa'.K_MnHa'}_K_MnAAAH}_KAAAHHa)\n      /\\ ____(EVENT_1)____(AAAH,____(EVENT_0)____,k_faha1,K_FaHa')\n      /\\ witness(AAAH,____(EVENT_3)____,____(EVENT_2)____,K_FaHa')\n      /\\ witness(AAAH,____(EVENT_5)____,k_mnfa1,____(EVENT_4)____)\n      /\\ witness(AAAH,MN,____(EVENT_6)____,____(EVENT_7)____)\n      /\\ ____(EVENT_9)____(____(EVENT_8)____,MN,k_mnha2,K_MnHa')\n      /\\ ____(EVENT_10)____(AAAH,____(EVENT_11)____,k_mnha1,K_MnHa')\n\n   2. State = 1\n      /\\ Rcv( {K_MnFa.K_MnHa}_K_MnAAAH.\n              {{K_MnFa.K_MnHa}_K_MnAAAH}_K_MnHa.\n               {{K_MnFa.K_MnHa}_K_MnAAAH.\n                {{K_MnFa.K_MnHa}_K_MnAAAH}_K_MnHa}_KAAAHHa)\n      =|>\n      State' := 2\n      /\\ Snd( FA.{K_MnFa.K_FaHa}_K_AAAHAAAL.{K_MnFa.K_MnHa}_K_MnAAAH.\n                {{K_MnFa.K_MnHa}_K_MnAAAH}_K_MnHa.\n\t     {FA.{K_MnFa.K_FaHa}_K_AAAHAAAL.{K_MnFa.K_MnHa}_K_MnAAAH.\n                {{K_MnFa.K_MnHa}_K_MnAAAH}_K_MnHa}_K_AAAHAAAL)\t\n      /\\ secret(K_FaHa,____(EVENT_13)____,{FA,____(EVENT_12)____}) \n      /\\ ____(EVENT_15)____(K_MnFa,____(EVENT_14)____,{FA,MN})\n      /\\ secret(K_MnHa,____(EVENT_17)____,{____(EVENT_16)____,HA})\n\nend role\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nrole aaa_MIP_HA (HA,AAAH,____(PARAM_17)____: ____(PARAM_16)____,\n                 Snd,____(PARAM_15)____: channel(dy),\n                 K_AAAHHa: symmetric_key)\nplayed_by HA\ndef=\n\n  local\n    State                 : nat,\n    K_MnFa,K_FaHa, K_MnHa : symmetric_key,\n    KeyMnFaKeyMnHa        : {symmetric_key.symmetric_key}_symmetric_key\n\n\n  init State := 0\n\n  transition\n\n   1. State = 0\n      /\\ Rcv( MN.{K_MnHa'.K_FaHa'}_K_AAAHHa.KeyMnFaKeyMnHa'.\n             {MN.{K_MnHa'.K_FaHa'}_K_AAAHHa.KeyMnFaKeyMnHa'}_K_AAAHHa) \n      =|> \n      State' := 1\n      /\\ Snd( KeyMnFaKeyMnHa'.{KeyMnFaKeyMnHa'}_K_MnHa'.\n             {KeyMnFaKeyMnHa'.{KeyMnFaKeyMnHa'}_K_MnHa'}_K_AAAHHa)\n      /\\ wrequest(HA,AAAH,k_faha2,K_FaHa')\n      /\\ wrequest(HA,AAAH,k_mnha1,K_MnHa')\nend role\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nrole ____(ROLE_2)____(MN,FA,AAAL,AAAH,HA: ____(PARAM_21)____,\n\t     Kmn3ah,____(PARAM_18)____,____(PARAM_20)____,____(PARAM_19)____: ____(PARAM_22)____) def=\n\n   local     MNs,____(VARIABLE_4)____,\n\t     FAs,FAr,\n\t     Ls, Lr,\n\t     Hs, Hr,\n\t     HAs, HAr: channel(dy)\n\n   composition\n\n           aaa_MIP_MN(MN,AAAH,FA,MNs,MNr,Kmn3ah)\n\n        /\\ aaa_MIP_FA(FA,AAAL,AAAH,MN,FAs,FAr,Kfa3al)\n  \n        /\\ aaa_MIP_AAAL(AAAL,AAAH,FA,MN,Ls,Lr,Kfa3al,K3ah3al)\n\n        /\\ aaa_MIP_AAAH(AAAH,AAAL,HA,FA,MN,Hs,Hr,Kmn3ah,K3ah3al,Kha3ah)\n         \n        /\\ aaa_MIP_HA(HA,AAAH,MN,HAs,HAr,Kha3ah)\nend role\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nrole ____(ROLE_1)____() def=\n\n  const k_mnha1, ____(VARIABLE_6)____, k_faha1                    : ____(VARIABLE_5)____,\n        k_mnha2, k_mnfa2, k_faha2                    : protocol_id,\n        mn, fa, aaal, aaah, ha                       : agent,\n        k_mn_aaah, k_fa_aaal, k_aaah_aaal, k_ha_aaah : symmetric_key\n\n  intruder_knowledge = {mn,fa,aaal,aaah,ha}\n\n  composition\n\n\tsession(mn,fa,aaal,aaah,ha,\t                    %%% Agents\n\t\tk_mn_aaah,k_fa_aaal,k_aaah_aaal,k_ha_aaah)  %%% Shared Keys\n%%%\t/\\ session(i,mn,aaal,aaah,ha,\t%%% Agents\n%%%\t\tk_i_aaah,k_mn_aaal,k_aaah_aaal,k_ha_aaah)  %%% Shared Keys\n%%%     intruder_knowledge += {k_i_aaah}\n%%%\t/\\ session(mn,i,aaal,aaah,ha,\t%%% Agents\n%%%\t\tk_mn_aaah,k_i_aaal,k_aaah_aaal,k_ha_aaah)  %%% Shared Keys\n%%% % necessarily flawed:\n%%% %\t/\\ session(mn,fa,i,aaah,ha,\t              %%% Agents\n%%% % \t\tk_mn_aaah,k_fa_i,k_aaah_i,k_ha_aaah)  %%% Shared Keys\n%%% % necessarily flawed:\n%%% %\t/\\ session(mn,fa,aaal,i,ha,\t           %%% Agents\n%%% % \t\tk_mn_i,k_fa_aaal,k_i_aaal,k_ha_i)  %%% Shared Keys\n%%%\t/\\ session(mn,fa,aaal,aaah,i,\t                   %%% Agents\n%%% \t\tk_mn_aaah,k_fa_aaal,k_aaah_aaal,k_i_aaah)  %%% Shared Keys\n\nend role\n\n____(ROLE_0)____\n\n  %secrecy_of K_MnFa, K_FaHa, K_MnFa\n  secrecy_of secFAHA, secFAMN, secMNHA % addresses G12\n\n  %AAA_MIP_FA weakly authenticates AAA_MIP_AAAH on k_faha1\n  weak_authentication_on k_faha1 % addresses G1,G7,G10\n  %AAA_MIP_FA weakly authenticates AAA_MIP_AAAH on k_mnfa1\n  weak_authentication_on k_mnfa1 % addresses G1,G7,G10\n  %AAA_MIP_HA weakly authenticates AAA_MIP_AAAH on k_faha2\n  weak_authentication_on k_faha2 % addresses G1,G7,G10\n  %AAA_MIP_HA weakly authenticates AAA_MIP_AAAH on k_mnha1\n  weak_authentication_on k_mnha1 % addresses G1,G7,G10\n  %AAA_MIP_MN weakly authenticates AAA_MIP_AAAH on k_mnha2\n  weak_authentication_on k_mnha2 % addresses G1,G7,G10\n  %AAA_MIP_MN weakly authenticates AAA_MIP_AAAH on k_mnfa2\n  weak_authentication_on k_mnfa2 % addresses G1,G7,G10\n\nend goal\n\nenvironment()",
        "complete:": "%% PROTOCOL: AAA Mobile IP\n%%\n%% PURPOSE:\n%%   This document specifies a Diameter application that allows a Diameter\n%%   server to authenticate, authorise and collect accounting information\n%%   for Mobile IPv4 services rendered to a mobile node.\n%%\n%% REFERENCE:\n%%   \\begin{itemize}\n%%   \\item \\cite{mip4-rfc3012bis,aaa-diameter-mobileip}\n%%   \\end{itemize}\n%%\n%% MODELER:\n%%   \\begin{itemize}\n%%   \\item Haykal Tej, Siemens CT IC 3, 2003\n%%   \\item Paul Hankes Drielsma, Information Security Group,  ETH Z\\\"{u}rich, December 2003\n%%   \\item Sebastian M\\\"odersheim, Information Security Group, ETH Z\\\"{u}rich, January 2004\n%%   \\item Luca Compagna, AI-Lab DIST, University of Genova, December 2004\n%%   \\end{itemize}\n%% ALICE_BOB:\n%% \\begin{verbatim}\n%% 1. FA   -> MN:   FA,N_FA\n%% 2. MN   -> FA:   N_FA,MN,AAAH,\n%%                  {N_FA,MN,AAAH}_K_MnAAAH\n%% 3. FA   -> AAAL: N_FA,MN,AAAH,\n%%                  {N_FA,MN,AAAH}_K_MnAAAH\n%% 4. AAAL -> AAAH: N_FA,MN,AAAH,\n%%                  {N_FA,MN,AAAH}_K_MnAAAH      \n%% 5. AAAH -> HA:   MN,\n%%                  {K_MnHa,K_FaHa}_KAAAHHa,\n%%                  {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                  {MN,\n%%                   {K_MnHa,K_FaHa}_KAAAHHa,\n%%                   {K_MnFa,K_MnHa}_K_MnAAAH\n%%                  }_K_AAAHHa\n%% 6. HA   -> AAAH: {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                  {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa,\n%%                  {{K_MnFa,K_MnHa}_K_MnAAAH,\n%%                   {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa\n%%                  }_K_AAAHHa\n%% 7. AAAH -> AAAL: N_FA,\n%%                  {K_MnFa,K_FaHa}_K_AAAHAAAL,\n%%                  {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                  {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa,\n%%                  {N_FA,\n%%                   {K_MnFa,K_FaHa}_K_AAAHAAAL,\n%%                   {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                   {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa\n%%                  }_K_AAAHAAAL\n%% 8. AAAL -> FA:   N_FA,\n%%                  {K_MnFa,K_FaHa}_K_FaAAAL,\n%%                  {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                  {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa,\n%%                  {N_FA,\n%%                   {K_MnFa,K_FaHa}_K_FaAAAL,\n%%                   {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                   {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa\n%%                  }_K_FaAAAL\n%% 9. FA   -> MN:   {K_MnFa,K_FaHa}_K_FaAAAL,\n%%                  {K_MnFa,K_MnHa}_K_MnAAAH,\n%%                  {{K_MnFa,K_MnHa}_K_MnAAAH}_K_MnHa\n%% \\end{verbatim}\n%% PROBLEMS: 7\n%% CLASSIFICATION: G1, G7, G10, G12\n%% ATTACKS:\n%% \\begin{verbatim}\n%% i      -> (mn,3): fa,fa\n%% (mn,3) -> i:      fa,mn,aaah,{fa,mn,aaah}k_mn_aaah\n%% i      -> (mn,3): {fa,mn,aaah}k_mn_aaah,{{fa,mn,aaah}k_mn_aaah}(mn,aaah)\n%% \\end{verbatim}\n%% In this type-flaw attack, the intruder replays the message \n%% \\verb+{fa,mn,aaah}k_mn_aaah+  to the mobile node, which expects to receive\n%% a message of the form \\verb+{fa,NewKey}k_mn_aaah+ where NewKey is the\n%% new key, which is thus matched with the pair of agent names \\verb+mn,aah+. \n%% Since the intruder knows these two agent names, he can also produce a \n%% message encrypted with this new key as required.\n%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% \t\n%%  HLPSL:\n\nrole aaa_MIP_MN (MN, AAAH, FA : agent,\n                 Snd, Rcv     : channel(dy),\n                 K_MnAAAH     : symmetric_key)\nplayed_by MN\ndef=\n\n  local  State         : nat,\n\t K_MnFa,K_MnHa : symmetric_key\n\n  init   State := 0\n\n  transition\n\n   1. State = 0\n      /\\ Rcv(FA.FA)\n      =|> \n      State' := 1\n      /\\  Snd(FA.MN.AAAH.{FA.MN.AAAH}_K_MnAAAH) \n\n   2. State = 1\n      /\\ Rcv( {K_MnFa'.K_MnHa'}_K_MnAAAH.\n             {{K_MnFa'.K_MnHa'}_K_MnAAAH}_K_MnHa') \n      =|>  \n      State' := 2 \n      /\\ wrequest(MN,AAAH,k_mnha2,K_MnHa')\n      /\\ wrequest(MN,AAAH,k_mnfa2,K_MnFa')\n\nend role\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nrole aaa_MIP_FA (FA,AAAL,AAAH,MN: agent,\n                 Snd, Rcv: channel(dy),\n                 K_FaAAAL: symmetric_key)\nplayed_by FA\ndef=\n\n  local\n    State              : nat,\n    K_MnFa, K_FaHa     : symmetric_key,\n    SignedRegReq       : {agent.(agent.agent)}_symmetric_key,\n    KeyMnHaKeyMnFa     : {symmetric_key.symmetric_key}_symmetric_key,\n    SignKeyMnHaKeyMnFa : \n         {{symmetric_key.symmetric_key}_symmetric_key}_symmetric_key\n\n  init State := 0\n\n  transition\n\n   1. State = 0\n      /\\ Rcv(start)\n      =|> \n      State' := 1\n      /\\ Snd(FA.FA) \n\n   2. State = 1\n      /\\ Rcv(FA.MN.AAAH.SignedRegReq')\n      =|> \n      State' := 2\n      /\\ Snd(FA.MN.AAAH.SignedRegReq') \n\t\n   3. State = 2\n      /\\ Rcv( FA.{K_MnFa'.K_FaHa'}_K_FaAAAL.\n              KeyMnHaKeyMnFa'.SignKeyMnHaKeyMnFa'.\n              {FA.{K_MnFa'.K_FaHa'}_K_FaAAAL.\n               KeyMnHaKeyMnFa'.SignKeyMnHaKeyMnFa'}_K_FaAAAL)\n      =|>\n      State' := 3\n      /\\ Snd(KeyMnHaKeyMnFa'.SignKeyMnHaKeyMnFa') \n      /\\ wrequest(FA,AAAH,k_faha1,K_FaHa')\n      /\\ wrequest(FA,AAAH,k_mnfa1,K_MnFa')\n\nend role\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nrole aaa_MIP_AAAL (AAAL,AAAH,FA,MN: agent,\n                  Snd, Rcv: channel(dy),\n                  K_FaAAAL,K_AAAHAAAL: symmetric_key)\nplayed_by AAAL\ndef=\n\n  local\n    State                : nat,\n    K_MnFa,K_FaHa        : symmetric_key,\n    SignedRegReq         : {agent.(agent.agent)}_symmetric_key,\n    KeyMnFaKeyMnHa       : {symmetric_key.symmetric_key}_symmetric_key,\n    SignedKeyMnFaKeyMnHa : \n           {{symmetric_key.symmetric_key}_symmetric_key}_symmetric_key\n\n  init State := 0\n  \n  transition\n\n   1. State = 0\n      /\\ Rcv(FA.MN.AAAH.SignedRegReq')\n      =|> \n      State' := 1 \n      /\\ Snd(FA.MN.AAAH. SignedRegReq') \n\n   2. State = 1\n      /\\ Rcv( FA.{K_MnFa'.K_FaHa'}_K_AAAHAAAL.\n              KeyMnFaKeyMnHa'.SignedKeyMnFaKeyMnHa'.\n              {FA.{K_MnFa'.K_FaHa'}_K_AAAHAAAL.\n               KeyMnFaKeyMnHa'.SignedKeyMnFaKeyMnHa'}_K_AAAHAAAL)\n      =|>\n      State' := 2\n      /\\ Snd( FA.{K_MnFa'.K_FaHa'}_K_FaAAAL.\n                 KeyMnFaKeyMnHa'.SignedKeyMnFaKeyMnHa'.\n             {FA.{K_MnFa'.K_FaHa'}_K_FaAAAL.\n                 KeyMnFaKeyMnHa'.SignedKeyMnFaKeyMnHa'}_K_FaAAAL)\n\nend role\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nrole aaa_MIP_AAAH (AAAH,AAAL,HA,FA,MN : agent,\n           Snd, Rcv : channel(dy),\n           K_MnAAAH,\n           K_AAAHAAAL,\n           KAAAHHa : symmetric_key)\nplayed_by AAAH\ndef=\n\n  local  State                : nat,\n\t K_FaHa,K_MnHa,K_MnFa : symmetric_key\n\n  const  secFAHA, secFAMN, secMNHA   : protocol_id\n\n  init   State := 0\n\n  transition\n\n   1. State   = 0\n      /\\ Rcv(FA.MN.AAAH.{FA.MN.AAAH}_K_MnAAAH)\n      =|> \n      State' := 1\n      /\\ K_MnHa' := new()\n      /\\ K_MnFa' := new()\n      /\\ K_FaHa' := new()\n      /\\ Snd( MN.{K_MnHa'.K_FaHa'}_KAAAHHa.\n                 {K_MnFa'.K_MnHa'}_K_MnAAAH.\n                 {MN.{K_MnHa'.K_FaHa'}_KAAAHHa.\n                     {K_MnFa'.K_MnHa'}_K_MnAAAH}_KAAAHHa)\n      /\\ witness(AAAH,FA,k_faha1,K_FaHa')\n      /\\ witness(AAAH,HA,k_faha2,K_FaHa')\n      /\\ witness(AAAH,FA,k_mnfa1,K_MnFa')\n      /\\ witness(AAAH,MN,k_mnfa2,K_MnFa')\n      /\\ witness(AAAH,MN,k_mnha2,K_MnHa')\n      /\\ witness(AAAH,HA,k_mnha1,K_MnHa')\n\n   2. State = 1\n      /\\ Rcv( {K_MnFa.K_MnHa}_K_MnAAAH.\n              {{K_MnFa.K_MnHa}_K_MnAAAH}_K_MnHa.\n               {{K_MnFa.K_MnHa}_K_MnAAAH.\n                {{K_MnFa.K_MnHa}_K_MnAAAH}_K_MnHa}_KAAAHHa)\n      =|>\n      State' := 2\n      /\\ Snd( FA.{K_MnFa.K_FaHa}_K_AAAHAAAL.{K_MnFa.K_MnHa}_K_MnAAAH.\n                {{K_MnFa.K_MnHa}_K_MnAAAH}_K_MnHa.\n\t     {FA.{K_MnFa.K_FaHa}_K_AAAHAAAL.{K_MnFa.K_MnHa}_K_MnAAAH.\n                {{K_MnFa.K_MnHa}_K_MnAAAH}_K_MnHa}_K_AAAHAAAL)\t\n      /\\ secret(K_FaHa,secFAHA,{FA,HA}) \n      /\\ secret(K_MnFa,secFAMN,{FA,MN})\n      /\\ secret(K_MnHa,secMNHA,{MN,HA})\n\nend role\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nrole aaa_MIP_HA (HA,AAAH,MN: agent,\n                 Snd,Rcv: channel(dy),\n                 K_AAAHHa: symmetric_key)\nplayed_by HA\ndef=\n\n  local\n    State                 : nat,\n    K_MnFa,K_FaHa, K_MnHa : symmetric_key,\n    KeyMnFaKeyMnHa        : {symmetric_key.symmetric_key}_symmetric_key\n\n\n  init State := 0\n\n  transition\n\n   1. State = 0\n      /\\ Rcv( MN.{K_MnHa'.K_FaHa'}_K_AAAHHa.KeyMnFaKeyMnHa'.\n             {MN.{K_MnHa'.K_FaHa'}_K_AAAHHa.KeyMnFaKeyMnHa'}_K_AAAHHa) \n      =|> \n      State' := 1\n      /\\ Snd( KeyMnFaKeyMnHa'.{KeyMnFaKeyMnHa'}_K_MnHa'.\n             {KeyMnFaKeyMnHa'.{KeyMnFaKeyMnHa'}_K_MnHa'}_K_AAAHHa)\n      /\\ wrequest(HA,AAAH,k_faha2,K_FaHa')\n      /\\ wrequest(HA,AAAH,k_mnha1,K_MnHa')\nend role\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nrole session(MN,FA,AAAL,AAAH,HA: agent,\n\t     Kmn3ah,Kfa3al,K3ah3al,Kha3ah: symmetric_key) def=\n\n   local     MNs,MNr,\n\t     FAs,FAr,\n\t     Ls, Lr,\n\t     Hs, Hr,\n\t     HAs, HAr: channel(dy)\n\n   composition\n\n           aaa_MIP_MN(MN,AAAH,FA,MNs,MNr,Kmn3ah)\n\n        /\\ aaa_MIP_FA(FA,AAAL,AAAH,MN,FAs,FAr,Kfa3al)\n  \n        /\\ aaa_MIP_AAAL(AAAL,AAAH,FA,MN,Ls,Lr,Kfa3al,K3ah3al)\n\n        /\\ aaa_MIP_AAAH(AAAH,AAAL,HA,FA,MN,Hs,Hr,Kmn3ah,K3ah3al,Kha3ah)\n         \n        /\\ aaa_MIP_HA(HA,AAAH,MN,HAs,HAr,Kha3ah)\nend role\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nrole environment() def=\n\n  const k_mnha1, k_mnfa1, k_faha1                    : protocol_id,\n        k_mnha2, k_mnfa2, k_faha2                    : protocol_id,\n        mn, fa, aaal, aaah, ha                       : agent,\n        k_mn_aaah, k_fa_aaal, k_aaah_aaal, k_ha_aaah : symmetric_key\n\n  intruder_knowledge = {mn,fa,aaal,aaah,ha}\n\n  composition\n\n\tsession(mn,fa,aaal,aaah,ha,\t                    %%% Agents\n\t\tk_mn_aaah,k_fa_aaal,k_aaah_aaal,k_ha_aaah)  %%% Shared Keys\n%%%\t/\\ session(i,mn,aaal,aaah,ha,\t%%% Agents\n%%%\t\tk_i_aaah,k_mn_aaal,k_aaah_aaal,k_ha_aaah)  %%% Shared Keys\n%%%     intruder_knowledge += {k_i_aaah}\n%%%\t/\\ session(mn,i,aaal,aaah,ha,\t%%% Agents\n%%%\t\tk_mn_aaah,k_i_aaal,k_aaah_aaal,k_ha_aaah)  %%% Shared Keys\n%%% % necessarily flawed:\n%%% %\t/\\ session(mn,fa,i,aaah,ha,\t              %%% Agents\n%%% % \t\tk_mn_aaah,k_fa_i,k_aaah_i,k_ha_aaah)  %%% Shared Keys\n%%% % necessarily flawed:\n%%% %\t/\\ session(mn,fa,aaal,i,ha,\t           %%% Agents\n%%% % \t\tk_mn_i,k_fa_aaal,k_i_aaal,k_ha_i)  %%% Shared Keys\n%%%\t/\\ session(mn,fa,aaal,aaah,i,\t                   %%% Agents\n%%% \t\tk_mn_aaah,k_fa_aaal,k_aaah_aaal,k_i_aaah)  %%% Shared Keys\n\nend role\n\ngoal\n\n  %secrecy_of K_MnFa, K_FaHa, K_MnFa\n  secrecy_of secFAHA, secFAMN, secMNHA % addresses G12\n\n  %AAA_MIP_FA weakly authenticates AAA_MIP_AAAH on k_faha1\n  weak_authentication_on k_faha1 % addresses G1,G7,G10\n  %AAA_MIP_FA weakly authenticates AAA_MIP_AAAH on k_mnfa1\n  weak_authentication_on k_mnfa1 % addresses G1,G7,G10\n  %AAA_MIP_HA weakly authenticates AAA_MIP_AAAH on k_faha2\n  weak_authentication_on k_faha2 % addresses G1,G7,G10\n  %AAA_MIP_HA weakly authenticates AAA_MIP_AAAH on k_mnha1\n  weak_authentication_on k_mnha1 % addresses G1,G7,G10\n  %AAA_MIP_MN weakly authenticates AAA_MIP_AAAH on k_mnha2\n  weak_authentication_on k_mnha2 % addresses G1,G7,G10\n  %AAA_MIP_MN weakly authenticates AAA_MIP_AAAH on k_mnfa2\n  weak_authentication_on k_mnfa2 % addresses G1,G7,G10\n\nend goal\n\nenvironment()"
    }
]
**Protocol Description: Needham-Schroeder-Lowe Protocol (NSL3)**


/* \n * Needham-Schroeder-Lowe protocol\n */\n\n// The protocol description\n\nprotocol nsl3(I,R)\n{\n\t// Initiator role (I) attempting to establish a secure connection with Responder (R)\n\trole I\n\t{\n\t\t// Generate a fresh nonce (ni) for this session\n\t\tfresh ni: Nonce;\n\t\t// Variable to store the responder's nonce (nr)\n\t\tvar nr: Nonce;\n\n\t\t// Step 1: Send the initiator's identity and nonce, encrypted with the responder's public key\n\t\tsend_1(I,R, {I,ni}pk(R) );\n\t\t// Step 2: Receive the initiator's nonce, responder's nonce, and responder's identity, encrypted with the initiator's public key\n\t\trecv_2(R,I, {ni,nr,R}pk(I) );\n\t\t// Step 3: Send the responder's nonce, encrypted with the responder's public key\n\t\tsend_3(I,R, {nr}pk(R) );\n\n\t\t// Claim that ni is a secret known only to the initiator\n\t\tclaim_i1(I,Secret,ni);\n\t\t// Claim that nr is a secret known only to the initiator (and implicitly the responder)\n\t\tclaim_i2(I,Secret,nr);\n\t\t// Claim that the initiator agrees on the nonces with the responder (Niagree)\n\t\tclaim_i3(I,Niagree);\n\t\t// Claim that the initiator is synchronized with the responder (Nisynch)\n\t\tclaim_i4(I,Nisynch);\n\t}\t\n\t\n\t// Responder role (R) responding to the initiator's (I) attempt to establish a secure connection\n\trole R\n\t{\n\t\t// Variable to store the initiator's nonce (ni)\n\t\tvar ni: Nonce;\n\t\t// Generate a fresh nonce (nr) for this session\n\t\tfresh nr: Nonce;\n\n\t\t// Step 1: Receive the initiator's identity and nonce, encrypted with the responder's public key\n\t\trecv_1(I,R, {I,ni}pk(R) );\n\t\t// Step 2: Send the initiator's nonce, responder's nonce, and responder's identity, encrypted with the initiator's public key\n\t\tsend_2(R,I, {ni,nr,R}pk(I) );\n\t\t// Step 3: Receive the responder's nonce, encrypted with the responder's public key\n\t\trecv_3(I,R, {nr}pk(R) );\n\n\t\t// Claim that ni is a secret known only to the responder (and implicitly the initiator)\n\t\tclaim_r1(R,Secret,ni);\n\t\t// Claim that nr is a secret known only to the responder\n\t\tclaim_r2(R,Secret,nr);\n\t\t// Claim that the responder agrees on the nonces with the initiator (Niagree)\n\t\tclaim_r3(R,Niagree);\n\t\t// Claim that the responder is synchronized with the initiator (Nisynch)\n\t\tclaim_r4(R,Nisynch);\n\t}\n}